#!/bin/bash

# check running from the web root
CURRENT_DIR=${PWD##*/}
if [ ! "$CURRENT_DIR" = "web" ]; then
  echo 'Please be sure that you are running this command from the web root.'
  exit 2
fi

# remove the local db
drush sql-drop -y

# download the prod db
drush sql-sync @gigeconomydata.master @gig.dev --sanitize -y

drush cr

# check whether to keep the prod config in place
while :; do
  case $1 in
    -c|--config) CONFIG="YES"
    ;;
    *) break
  esac
  shift
done

if [ "$CONFIG" != "YES" ]; then
  # import local config
  drush cim -y
  drush csim -y
fi

echo "Sync complete."
